"use strict";var Vn=Object.create;var Ve=Object.defineProperty;var _n=Object.getOwnPropertyDescriptor;var Fn=Object.getOwnPropertyNames;var Nn=Object.getPrototypeOf,Un=Object.prototype.hasOwnProperty;var x=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Mn=(e,t)=>{for(var r in t)Ve(e,r,{get:t[r],enumerable:!0})},Kt=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Fn(t))!Un.call(e,n)&&n!==r&&Ve(e,n,{get:()=>t[n],enumerable:!(o=_n(t,n))||o.enumerable});return e};var G=(e,t,r)=>(r=e!=null?Vn(Nn(e)):{},Kt(t||!e||!e.__esModule?Ve(r,"default",{value:e,enumerable:!0}):r,e)),Gn=e=>Kt(Ve({},"__esModule",{value:!0}),e);var tr=x((da,er)=>{er.exports=Zt;Zt.sync=jn;var Jt=require("fs");function Wn(e,t){var r=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var o=0;o<r.length;o++){var n=r[o].toLowerCase();if(n&&e.substr(-n.length).toLowerCase()===n)return!0}return!1}function Qt(e,t,r){return!e.isSymbolicLink()&&!e.isFile()?!1:Wn(t,r)}function Zt(e,t,r){Jt.stat(e,function(o,n){r(o,o?!1:Qt(n,e,t))})}function jn(e,t){return Qt(Jt.statSync(e),e,t)}});var ir=x((pa,sr)=>{sr.exports=or;or.sync=Kn;var rr=require("fs");function or(e,t,r){rr.stat(e,function(o,n){r(o,o?!1:nr(n,t))})}function Kn(e,t){return nr(rr.statSync(e),t)}function nr(e,t){return e.isFile()&&qn(e,t)}function qn(e,t){var r=e.mode,o=e.uid,n=e.gid,s=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),i=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),p=a|c,y=r&u||r&c&&n===i||r&a&&o===s||r&p&&s===0;return y}});var cr=x((fa,ar)=>{var ma=require("fs"),Ne;process.platform==="win32"||global.TESTING_WINDOWS?Ne=tr():Ne=ir();ar.exports=nt;nt.sync=zn;function nt(e,t,r){if(typeof t=="function"&&(r=t,t={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(o,n){nt(e,t||{},function(s,i){s?n(s):o(i)})})}Ne(e,t||{},function(o,n){o&&(o.code==="EACCES"||t&&t.ignoreErrors)&&(o=null,n=!1),r(o,n)})}function zn(e,t){try{return Ne.sync(e,t||{})}catch(r){if(t&&t.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var hr=x((ha,fr)=>{var pe=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",ur=require("path"),Yn=pe?";":":",lr=cr(),dr=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),pr=(e,t)=>{let r=t.colon||Yn,o=e.match(/\//)||pe&&e.match(/\\/)?[""]:[...pe?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],n=pe?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=pe?n.split(r):[""];return pe&&e.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:o,pathExt:s,pathExtExe:n}},mr=(e,t,r)=>{typeof t=="function"&&(r=t,t={}),t||(t={});let{pathEnv:o,pathExt:n,pathExtExe:s}=pr(e,t),i=[],a=u=>new Promise((p,y)=>{if(u===o.length)return t.all&&i.length?p(i):y(dr(e));let S=o[u],l=/^".*"$/.test(S)?S.slice(1,-1):S,d=ur.join(l,e),w=!l&&/^\.[\\\/]/.test(e)?e.slice(0,2)+d:d;p(c(w,u,0))}),c=(u,p,y)=>new Promise((S,l)=>{if(y===n.length)return S(a(p+1));let d=n[y];lr(u+d,{pathExt:s},(w,B)=>{if(!w&&B)if(t.all)i.push(u+d);else return S(u+d);return S(c(u,p,y+1))})});return r?a(0).then(u=>r(null,u),r):a(0)},Xn=(e,t)=>{t=t||{};let{pathEnv:r,pathExt:o,pathExtExe:n}=pr(e,t),s=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,u=ur.join(c,e),p=!c&&/^\.[\\\/]/.test(e)?e.slice(0,2)+u:u;for(let y=0;y<o.length;y++){let S=p+o[y];try{if(lr.sync(S,{pathExt:n}))if(t.all)s.push(S);else return S}catch{}}}if(t.all&&s.length)return s;if(t.nothrow)return null;throw dr(e)};fr.exports=mr;mr.sync=Xn});var gr=x((ya,st)=>{"use strict";var yr=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(o=>o.toUpperCase()==="PATH")||"Path"};st.exports=yr;st.exports.default=yr});var Pr=x((ga,Ir)=>{"use strict";var Sr=require("path"),Jn=hr(),Qn=gr();function wr(e,t){let r=e.options.env||process.env,o=process.cwd(),n=e.options.cwd!=null,s=n&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(e.options.cwd)}catch{}let i;try{i=Jn.sync(e.command,{path:r[Qn({env:r})],pathExt:t?Sr.delimiter:void 0})}catch{}finally{s&&process.chdir(o)}return i&&(i=Sr.resolve(n?e.options.cwd:"",i)),i}function Zn(e){return wr(e)||wr(e,!0)}Ir.exports=Zn});var xr=x((Sa,at)=>{"use strict";var it=/([()\][%!^"`<>&|;, *?])/g;function es(e){return e=e.replace(it,"^$1"),e}function ts(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(it,"^$1"),t&&(e=e.replace(it,"^$1")),e}at.exports.command=es;at.exports.argument=ts});var br=x((wa,Er)=>{"use strict";Er.exports=/^#!(.*)/});var Cr=x((Ia,Tr)=>{"use strict";var rs=br();Tr.exports=(e="")=>{let t=e.match(rs);if(!t)return null;let[r,o]=t[0].replace(/#! ?/,"").split(" "),n=r.split("/").pop();return n==="env"?o:o?`${n} ${o}`:n}});var Ar=x((Pa,vr)=>{"use strict";var ct=require("fs"),os=Cr();function ns(e){let r=Buffer.alloc(150),o;try{o=ct.openSync(e,"r"),ct.readSync(o,r,0,150,0),ct.closeSync(o)}catch{}return os(r.toString())}vr.exports=ns});var Or=x((xa,Lr)=>{"use strict";var ss=require("path"),Rr=Pr(),kr=xr(),is=Ar(),as=process.platform==="win32",cs=/\.(?:com|exe)$/i,us=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function ls(e){e.file=Rr(e);let t=e.file&&is(e.file);return t?(e.args.unshift(e.file),e.command=t,Rr(e)):e.file}function ds(e){if(!as)return e;let t=ls(e),r=!cs.test(t);if(e.options.forceShell||r){let o=us.test(t);e.command=ss.normalize(e.command),e.command=kr.command(e.command),e.args=e.args.map(s=>kr.argument(s,o));let n=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${n}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function ps(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null),t=t?t.slice(0):[],r=Object.assign({},r);let o={command:e,args:t,options:r,file:void 0,original:{command:e,args:t}};return r.shell?o:ds(o)}Lr.exports=ps});var Fr=x((Ea,_r)=>{"use strict";var ut=process.platform==="win32";function lt(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function ms(e,t){if(!ut)return;let r=e.emit;e.emit=function(o,n){if(o==="exit"){let s=Vr(n,t,"spawn");if(s)return r.call(e,"error",s)}return r.apply(e,arguments)}}function Vr(e,t){return ut&&e===1&&!t.file?lt(t.original,"spawn"):null}function fs(e,t){return ut&&e===1&&!t.file?lt(t.original,"spawnSync"):null}_r.exports={hookChildProcess:ms,verifyENOENT:Vr,verifyENOENTSync:fs,notFoundError:lt}});var Mr=x((ba,me)=>{"use strict";var Nr=require("child_process"),dt=Or(),pt=Fr();function Ur(e,t,r){let o=dt(e,t,r),n=Nr.spawn(o.command,o.args,o.options);return pt.hookChildProcess(n,o),n}function hs(e,t,r){let o=dt(e,t,r),n=Nr.spawnSync(o.command,o.args,o.options);return n.error=n.error||pt.verifyENOENTSync(n.status,o),n}me.exports=Ur;me.exports.spawn=Ur;me.exports.sync=hs;me.exports._parse=dt;me.exports._enoent=pt});var Jr=x(($a,De)=>{De.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&De.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&De.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var ro=x((Wa,ge)=>{var g=global.process,ie=function(e){return e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function"};ie(g)?(Qr=require("assert"),he=Jr(),Zr=/^win/i.test(g.platform),Te=require("events"),typeof Te!="function"&&(Te=Te.EventEmitter),g.__signal_exit_emitter__?E=g.__signal_exit_emitter__:(E=g.__signal_exit_emitter__=new Te,E.count=0,E.emitted={}),E.infinite||(E.setMaxListeners(1/0),E.infinite=!0),ge.exports=function(e,t){if(!ie(global.process))return function(){};Qr.equal(typeof e,"function","a callback must be provided for exit handler"),ye===!1&&gt();var r="exit";t&&t.alwaysLast&&(r="afterexit");var o=function(){E.removeListener(r,e),E.listeners("exit").length===0&&E.listeners("afterexit").length===0&&Be()};return E.on(r,e),o},Be=function(){!ye||!ie(global.process)||(ye=!1,he.forEach(function(t){try{g.removeListener(t,He[t])}catch{}}),g.emit=$e,g.reallyExit=St,E.count-=1)},ge.exports.unload=Be,ae=function(t,r,o){E.emitted[t]||(E.emitted[t]=!0,E.emit(t,r,o))},He={},he.forEach(function(e){He[e]=function(){if(!!ie(global.process)){var r=g.listeners(e);r.length===E.count&&(Be(),ae("exit",null,e),ae("afterexit",null,e),Zr&&e==="SIGHUP"&&(e="SIGINT"),g.kill(g.pid,e))}}}),ge.exports.signals=function(){return he},ye=!1,gt=function(){ye||!ie(global.process)||(ye=!0,E.count+=1,he=he.filter(function(t){try{return g.on(t,He[t]),!0}catch{return!1}}),g.emit=to,g.reallyExit=eo)},ge.exports.load=gt,St=g.reallyExit,eo=function(t){!ie(global.process)||(g.exitCode=t||0,ae("exit",g.exitCode,null),ae("afterexit",g.exitCode,null),St.call(g,g.exitCode))},$e=g.emit,to=function(t,r){if(t==="exit"&&ie(global.process)){r!==void 0&&(g.exitCode=r);var o=$e.apply(this,arguments);return ae("exit",g.exitCode,null),ae("afterexit",g.exitCode,null),o}else return $e.apply(this,arguments)}):ge.exports=function(){return function(){}};var Qr,he,Zr,Te,E,Be,ae,He,ye,gt,St,eo,$e,to});var mo=x((qa,po)=>{"use strict";var{PassThrough:Gs}=require("stream");po.exports=e=>{e={...e};let{array:t}=e,{encoding:r}=e,o=r==="buffer",n=!1;t?n=!(r||o):r=r||"utf8",o&&(r=null);let s=new Gs({objectMode:n});r&&s.setEncoding(r);let i=0,a=[];return s.on("data",c=>{a.push(c),n?i=a.length:i+=c.length}),s.getBufferedValue=()=>t?a:o?Buffer.concat(a,i):a.join(""),s.getBufferedLength=()=>i,s}});var fo=x((za,Ce)=>{"use strict";var{constants:Ds}=require("buffer"),Bs=require("stream"),{promisify:Hs}=require("util"),$s=mo(),Ws=Hs(Bs.pipeline),We=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function wt(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};let{maxBuffer:r}=t,o=$s(t);return await new Promise((n,s)=>{let i=a=>{a&&o.getBufferedLength()<=Ds.MAX_LENGTH&&(a.bufferedData=o.getBufferedValue()),s(a)};(async()=>{try{await Ws(e,o),n()}catch(a){i(a)}})(),o.on("data",()=>{o.getBufferedLength()>r&&i(new We)})}),o.getBufferedValue()}Ce.exports=wt;Ce.exports.buffer=(e,t)=>wt(e,{...t,encoding:"buffer"});Ce.exports.array=(e,t)=>wt(e,{...t,array:!0});Ce.exports.MaxBufferError=We});var yo=x((Ya,ho)=>{"use strict";var{PassThrough:js}=require("stream");ho.exports=function(){var e=[],t=new js({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=o,t.on("unpipe",n),Array.prototype.slice.call(arguments).forEach(r),t;function r(s){return Array.isArray(s)?(s.forEach(r),this):(e.push(s),s.once("end",n.bind(null,s)),s.once("error",t.emit.bind(t,"error")),s.pipe(t,{end:!1}),this)}function o(){return e.length==0}function n(s){e=e.filter(function(i){return i!==s}),!e.length&&t.readable&&t.end()}}});var ra={};Mn(ra,{default:()=>ta});module.exports=Gn(ra);var oe=require("@raycast/api");var de=require("@raycast/api"),Xt=require("react");var ne=require("@raycast/api"),xe=require("react/jsx-runtime"),qt="```",zt="https://bitwarden.com/help/cli/#download-and-install",Dn="https://formulae.brew.sh/formula/bitwarden-cli",Bn="https://github.com/raycast/extensions/issues/new?assignees=&labels=extension%2Cbug&template=extension_bug_report.yml&title=%5BBitwarden%5D+...",Hn=e=>`# \u{1F6A8} Something went wrong
${e?`${qt}
${e}
${qt}`:`
`}
## Troubleshooting Guide:

1. The [Bitwarden CLI](${zt}) is correctly installed
2. If you did not install the Bitwarden CLI [using Homebrew](${Dn}), please check that the path of the installation matches the \`Bitwarden CLI Installation Path\` extension setting. 
    - \u{1F4A1} Run the \`which bw\` command to check the CLI installation path.

If you are still experiencing issues, please [open an issue on GitHub](${Bn}).
`,$n=e=>(0,xe.jsx)(ne.Detail,{markdown:Hn(e.errorInfo),actions:(0,xe.jsxs)(ne.ActionPanel,{children:[(0,xe.jsx)(ne.Action.CopyToClipboard,{title:"Copy Homebrew Installation Command",content:"brew install bitwarden-cli"}),(0,xe.jsx)(ne.Action.OpenInBrowser,{title:"Open Installation Guide",url:zt})]})}),ot=$n;var Fe={CLINotFound:"CLINotFound",FailedToLoadVaultItemsError:"FailedToLoadVaultItemsError"},_e=class extends Error{constructor(t){super(t),this.name=Fe.CLINotFound}},se=class extends Error{constructor(t){super(t??"Failed to load vault items"),this.name=Fe.CLINotFound}};var Yt=require("react/jsx-runtime"),Ee=class extends Xt.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}async componentDidCatch(t,r){t.name in Fe?(this.setState(o=>({...o,hasError:!0,error:t.message})),await(0,de.showToast)(de.Toast.Style.Failure,t.message)):(de.environment.isDevelopment&&this.setState(o=>({...o,hasError:!0,error:t.message})),console.error("Error:",t,r))}render(){try{return this.state.hasError?(0,Yt.jsx)(ot,{errorInfo:this.state.error}):this.props.children}catch{return(0,Yt.jsx)(ot,{})}}};var C=require("@raycast/api");var Xo=require("@raycast/api"),D=require("react");var m=require("@raycast/api"),ke=require("react");var Mo=require("@raycast/api"),Q=require("react");var b=require("@raycast/api");var To=require("node:buffer"),Co=G(require("node:path"),1),Tt=G(require("node:child_process"),1),ve=G(require("node:process"),1),vo=G(Mr(),1);function mt(e){let t=typeof e=="string"?`
`:`
`.charCodeAt(),r=typeof e=="string"?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===r&&(e=e.slice(0,-1)),e}var be=G(require("node:process"),1),fe=G(require("node:path"),1),Gr=G(require("node:url"),1);function Ue(e={}){let{env:t=process.env,platform:r=process.platform}=e;return r!=="win32"?"PATH":Object.keys(t).reverse().find(o=>o.toUpperCase()==="PATH")||"Path"}function ys(e={}){let{cwd:t=be.default.cwd(),path:r=be.default.env[Ue()],execPath:o=be.default.execPath}=e,n,s=t instanceof URL?Gr.default.fileURLToPath(t):t,i=fe.default.resolve(s),a=[];for(;n!==i;)a.push(fe.default.join(i,"node_modules/.bin")),n=i,i=fe.default.resolve(i,"..");return a.push(fe.default.resolve(s,o,"..")),[...a,r].join(fe.default.delimiter)}function Dr({env:e=be.default.env,...t}={}){e={...e};let r=Ue({env:e});return t.path=e[r],e[r]=ys(t),e}var gs=(e,t,r,o)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let n=Object.getOwnPropertyDescriptor(e,r),s=Object.getOwnPropertyDescriptor(t,r);!Ss(n,s)&&o||Object.defineProperty(e,r,s)},Ss=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},ws=(e,t)=>{let r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)},Is=(e,t)=>`/* Wrapped ${e}*/
${t}`,Ps=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),xs=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Es=(e,t,r)=>{let o=r===""?"":`with ${r.trim()}() `,n=Is.bind(null,o,t.toString());Object.defineProperty(n,"name",xs),Object.defineProperty(e,"toString",{...Ps,value:n})};function ft(e,t,{ignoreNonConfigurable:r=!1}={}){let{name:o}=e;for(let n of Reflect.ownKeys(t))gs(e,t,n,r);return ws(e,t),Es(e,t,o),e}var Me=new WeakMap,Br=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let r,o=0,n=e.displayName||e.name||"<anonymous>",s=function(...i){if(Me.set(s,++o),o===1)r=e.apply(this,i),e=null;else if(t.throw===!0)throw new Error(`Function \`${n}\` can only be called once`);return r};return ft(s,e),Me.set(s,o),s};Br.callCount=e=>{if(!Me.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return Me.get(e)};var Hr=Br;var zr=require("node:os");var $r=function(){let e=jr-Wr+1;return Array.from({length:e},bs)},bs=function(e,t){return{name:`SIGRT${t+1}`,number:Wr+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},Wr=34,jr=64;var qr=require("node:os");var Kr=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var ht=function(){let e=$r();return[...Kr,...e].map(Ts)},Ts=function({name:e,number:t,description:r,action:o,forced:n=!1,standard:s}){let{signals:{[e]:i}}=qr.constants,a=i!==void 0;return{name:e,number:a?i:t,description:r,supported:a,action:o,forced:n,standard:s}};var Cs=function(){let e=ht();return Object.fromEntries(e.map(vs))},vs=function({name:e,number:t,description:r,supported:o,action:n,forced:s,standard:i}){return[e,{name:e,number:t,description:r,supported:o,action:n,forced:s,standard:i}]},Yr=Cs(),As=function(){let e=ht(),t=64+1,r=Array.from({length:t},(o,n)=>Rs(n,e));return Object.assign({},...r)},Rs=function(e,t){let r=ks(e,t);if(r===void 0)return{};let{name:o,description:n,supported:s,action:i,forced:a,standard:c}=r;return{[e]:{name:o,number:e,description:n,supported:s,action:i,forced:a,standard:c}}},ks=function(e,t){let r=t.find(({name:o})=>zr.constants.signals[o]===e);return r!==void 0?r:t.find(o=>o.number===e)},Ma=As();var Ls=({timedOut:e,timeout:t,errorCode:r,signal:o,signalDescription:n,exitCode:s,isCanceled:i})=>e?`timed out after ${t} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:o!==void 0?`was killed with ${o} (${n})`:s!==void 0?`failed with exit code ${s}`:"failed",yt=({stdout:e,stderr:t,all:r,error:o,signal:n,exitCode:s,command:i,escapedCommand:a,timedOut:c,isCanceled:u,killed:p,parsed:{options:{timeout:y}}})=>{s=s===null?void 0:s,n=n===null?void 0:n;let S=n===void 0?void 0:Yr[n].description,l=o&&o.code,w=`Command ${Ls({timedOut:c,timeout:y,errorCode:l,signal:n,signalDescription:S,exitCode:s,isCanceled:u})}: ${i}`,B=Object.prototype.toString.call(o)==="[object Error]",z=B?`${w}
${o.message}`:w,J=[z,t,e].filter(Boolean).join(`
`);return B?(o.originalMessage=o.message,o.message=J):o=new Error(J),o.shortMessage=z,o.command=i,o.escapedCommand=a,o.exitCode=s,o.signal=n,o.signalDescription=S,o.stdout=e,o.stderr=t,r!==void 0&&(o.all=r),"bufferedData"in o&&delete o.bufferedData,o.failed=!0,o.timedOut=Boolean(c),o.isCanceled=u,o.killed=p&&!c,o};var Ge=["stdin","stdout","stderr"],Os=e=>Ge.some(t=>e[t]!==void 0),Xr=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return Ge.map(o=>e[o]);if(Os(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${Ge.map(o=>`\`${o}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let r=Math.max(t.length,Ge.length);return Array.from({length:r},(o,n)=>t[n])};var oo=G(require("node:os"),1),no=G(ro(),1),Vs=1e3*5,so=(e,t="SIGTERM",r={})=>{let o=e(t);return _s(e,t,r,o),o},_s=(e,t,r,o)=>{if(!Fs(t,r,o))return;let n=Us(r),s=setTimeout(()=>{e("SIGKILL")},n);s.unref&&s.unref()},Fs=(e,{forceKillAfterTimeout:t},r)=>Ns(e)&&t!==!1&&r,Ns=e=>e===oo.default.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",Us=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return Vs;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},io=(e,t)=>{e.kill()&&(t.isCanceled=!0)},Ms=(e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},ao=(e,{timeout:t,killSignal:r="SIGTERM"},o)=>{if(t===0||t===void 0)return o;let n,s=new Promise((a,c)=>{n=setTimeout(()=>{Ms(e,r,c)},t)}),i=o.finally(()=>{clearTimeout(n)});return Promise.race([s,i])},co=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},uo=async(e,{cleanup:t,detached:r},o)=>{if(!t||r)return o;let n=(0,no.default)(()=>{e.kill()});return o.finally(()=>{n()})};function lo(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}var xt=G(fo(),1),go=G(yo(),1),So=(e,t)=>{t!==void 0&&(lo(t)?t.pipe(e.stdin):e.stdin.end(t))},wo=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let r=(0,go.default)();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},It=async(e,t)=>{if(!(!e||t===void 0)){e.destroy();try{return await t}catch(r){return r.bufferedData}}},Pt=(e,{encoding:t,buffer:r,maxBuffer:o})=>{if(!(!e||!r))return t?(0,xt.default)(e,{encoding:t,maxBuffer:o}):xt.default.buffer(e,{maxBuffer:o})},Io=async({stdout:e,stderr:t,all:r},{encoding:o,buffer:n,maxBuffer:s},i)=>{let a=Pt(e,{encoding:o,buffer:n,maxBuffer:s}),c=Pt(t,{encoding:o,buffer:n,maxBuffer:s}),u=Pt(r,{encoding:o,buffer:n,maxBuffer:s*2});try{return await Promise.all([i,a,c,u])}catch(p){return Promise.all([{error:p,signal:p.signal,timedOut:p.timedOut},It(e,a),It(t,c),It(r,u)])}};var Ks=(async()=>{})().constructor.prototype,qs=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor(Ks,e)]),Et=(e,t)=>{for(let[r,o]of qs){let n=typeof t=="function"?(...s)=>Reflect.apply(o.value,t(),s):o.value.bind(t);Reflect.defineProperty(e,r,{...o,value:n})}return e},Po=e=>new Promise((t,r)=>{e.on("exit",(o,n)=>{t({exitCode:o,signal:n})}),e.on("error",o=>{r(o)}),e.stdin&&e.stdin.on("error",o=>{r(o)})});var xo=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],zs=/^[\w.-]+$/,Ys=/"/g,Xs=e=>typeof e!="string"||zs.test(e)?e:`"${e.replace(Ys,'\\"')}"`,Eo=(e,t)=>xo(e,t).join(" "),bo=(e,t)=>xo(e,t).map(r=>Xs(r)).join(" ");var Js=1e3*1e3*100,Qs=({env:e,extendEnv:t,preferLocal:r,localDir:o,execPath:n})=>{let s=t?{...ve.default.env,...e}:e;return r?Dr({env:s,cwd:o,execPath:n}):s},Zs=(e,t,r={})=>{let o=vo.default._parse(e,t,r);return e=o.command,t=o.args,r=o.options,r={maxBuffer:Js,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||ve.default.cwd(),execPath:ve.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r},r.env=Qs(r),r.stdio=Xr(r),ve.default.platform==="win32"&&Co.default.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:r,parsed:o}},bt=(e,t,r)=>typeof t!="string"&&!To.Buffer.isBuffer(t)?r===void 0?void 0:"":e.stripFinalNewline?mt(t):t;function Ao(e,t,r){let o=Zs(e,t,r),n=Eo(e,t),s=bo(e,t);co(o.options);let i;try{i=Tt.default.spawn(o.file,o.args,o.options)}catch(l){let d=new Tt.default.ChildProcess,w=Promise.reject(yt({error:l,stdout:"",stderr:"",all:"",command:n,escapedCommand:s,parsed:o,timedOut:!1,isCanceled:!1,killed:!1}));return Et(d,w)}let a=Po(i),c=ao(i,o.options,a),u=uo(i,o.options,c),p={isCanceled:!1};i.kill=so.bind(null,i.kill.bind(i)),i.cancel=io.bind(null,i,p);let S=Hr(async()=>{let[{error:l,exitCode:d,signal:w,timedOut:B},z,J,rt]=await Io(i,o.options,u),Ht=bt(o.options,z),$t=bt(o.options,J),Wt=bt(o.options,rt);if(l||d!==0||w!==null){let jt=yt({error:l,exitCode:d,signal:w,stdout:Ht,stderr:$t,all:Wt,command:n,escapedCommand:s,parsed:o,timedOut:B,isCanceled:p.isCanceled||(o.options.signal?o.options.signal.aborted:!1),killed:i.killed});if(!o.options.reject)return jt;throw jt}return{command:n,escapedCommand:s,exitCode:0,stdout:Ht,stderr:$t,all:Wt,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return So(i,o.options.input),i.all=wo(i,o.options),Et(i,S)}var Fo=require("fs"),No=require("path/posix");var Ro="https://bitwarden.com",Ae="HIDDEN-VALUE",T={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason"};var ei=require("@raycast/api"),Lo=require("crypto");var ko="foobarbazzybaz";function Oo(e){return Object.entries(e).flatMap(([t,r])=>r?[`--${t}`,r]:[])}async function Ct(e){return new Promise((t,r)=>{(0,Lo.pbkdf2)(e,ko,1e5,64,"sha512",(o,n)=>{if(o!=null){r(o);return}t(n.toString("hex"))})})}var Re=require("@raycast/api");var N={IMMEDIATELY:0,ONE_MINUTE:6e4,FIVE_MINUTES:3e5,FIFTEEN_MINUTES:9e5,THIRTY_MINUTES:18e5,ONE_HOUR:36e5,FOUR_HOURS:144e5,EIGHT_HOURS:288e5,ONE_DAY:864e5,NEVER:-1},Vo={[N.IMMEDIATELY]:"Immediately",[N.ONE_MINUTE]:"1 Minute",[N.FIVE_MINUTES]:"5 Minutes",[N.FIFTEEN_MINUTES]:"15 Minutes",[N.THIRTY_MINUTES]:"30 Minutes",[N.ONE_HOUR]:"1 Hour",[N.FOUR_HOURS]:"4 Hours",[N.EIGHT_HOURS]:"8 Hours",[N.ONE_DAY]:"1 Day"};function je(){let{serverUrl:e}=(0,Re.getPreferenceValues)();return e===""||e==="bitwarden.com"||e==="https://bitwarden.com"?"":e}var ti={search:"transientCopySearch","generate-password":"transientCopyGeneratePassword","generate-password-quick":"transientCopyGeneratePasswordQuick"};function V(e){let t=ti[Re.environment.commandName],r=(0,Re.getPreferenceValues)()[t];return r==="never"?!1:r==="always"?!0:r==="passwords"?e==="password":!0}function _o(e){return Vo[e]}var Ke=class{constructor(){let{cliPath:t,clientId:r,clientSecret:o,serverCertsPath:n}=(0,b.getPreferenceValues)(),s=je();if(this.cliPath=t||(process.arch=="arm64"?"/opt/homebrew/bin/bw":"/usr/local/bin/bw"),!(0,Fo.existsSync)(this.cliPath))throw new _e(`Bitwarden CLI not found at ${this.cliPath}`);this.env={BITWARDENCLI_APPDATA_DIR:b.environment.supportPath,BW_CLIENTSECRET:o.trim(),BW_CLIENTID:r.trim(),PATH:(0,No.dirname)(process.execPath),...s&&n?{NODE_EXTRA_CA_CERTS:n}:{}},this.initPromise=(async()=>{await this.checkServerUrl(s),this.lockReason=await b.LocalStorage.getItem(T.VAULT_LOCK_REASON)})()}setSessionToken(t){this.env={...this.env,BW_SESSION:t}}clearSessionToken(){delete this.env.BW_SESSION}withSession(t){return this.tempSessionToken=t,this}async initialize(){return await this.initPromise,this}async checkServerUrl(t){if((await b.LocalStorage.getItem(T.SERVER_URL)||"")===t)return;let o=await(0,b.showToast)({style:b.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",t||Ro]),await b.LocalStorage.setItem(T.SERVER_URL,t),o.style=b.Toast.Style.Success,o.title="Success",o.message="Bitwarden server changed"}catch(n){o.style=b.Toast.Style.Failure,o.title="Failed to switch server",n instanceof Error?o.message=n.message:o.message="Unknown error occurred"}}async setLockReason(t){this.lockReason=t,await b.LocalStorage.setItem(T.VAULT_LOCK_REASON,t)}async clearLockReason(){this.lockReason&&(await b.LocalStorage.removeItem(T.VAULT_LOCK_REASON),this.lockReason=void 0)}async exec(t,r){let{abortController:o,input:n="",skipLastActivityUpdate:s=!1}=r??{},i=this.env;this.tempSessionToken&&(i={...i,BW_SESSION:this.tempSessionToken});let a=await Ao(this.cliPath,t,{env:i,input:n,signal:o?.signal});return s||await b.LocalStorage.setItem(T.LAST_ACTIVITY_TIME,new Date().toISOString()),this.tempSessionToken&&(this.tempSessionToken=void 0),a}async sync(){await this.exec(["sync"])}async login(){await this.exec(["login","--apikey"]),await this.clearLockReason()}async logout(){await this.exec(["logout"]),this.clearSessionToken()}async listItems(){let{stdout:t}=await this.exec(["list","items"]);return JSON.parse(t).filter(o=>!!o.name)}async listFolders(){let{stdout:t}=await this.exec(["list","folders"]);return JSON.parse(t)}async getTotp(t){let{stdout:r}=await this.exec(["get","totp",t]);return r}async unlock(t){let{stdout:r}=await this.exec(["unlock",t,"--raw"]);return await this.clearLockReason(),r}async lock(t){t&&await this.setLockReason(t),await this.exec(["lock"])}async status(){let{stdout:t}=await this.exec(["status"]);return JSON.parse(t)}async checkLockStatus(){try{return await this.exec(["unlock","--check"]),"unlocked"}catch(t){return t.stderr==="Vault is locked."?"locked":"unauthenticated"}}async generatePassword(t,r){let o=t?Oo(t):[],{stdout:n}=await this.exec(["generate",...o],{abortController:r});return n}};var Uo=require("react/jsx-runtime"),Go=(0,Q.createContext)(null),Do=e=>{let{children:t}=e,[r,o]=(0,Q.useState)();return(0,Q.useEffect)(()=>{new Ke().initialize().then(o)},[]),r?(0,Uo.jsx)(Go.Provider,{value:r,children:t}):(0,Uo.jsx)(Mo.Detail,{isLoading:!0})},H=()=>{let e=(0,Q.useContext)(Go);if(e==null)throw new Error("useBitwarden must be used within a BitwardenProvider");return e};function Bo(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Ho(e,t){try{let r=e,o;return r?.stderr?o=r.stderr:e instanceof Error?o=`${e.name}: ${e.message}`:Bo(e)?o=JSON.stringify(e):o=`${e}`,o?t?.omitSensitiveValue?ri(o,t.omitSensitiveValue):o:""}catch{return""}}function ri(e,t){return e.replace(new RegExp(t,"i"),"[REDACTED]")}var $o=require("@raycast/api"),h=(e,t)=>{!$o.environment.isDevelopment||console.error(e,t)};var $=require("@raycast/api"),qe=require("react");function oi(){let e=H(),[t,r]=(0,qe.useState)(null);(0,qe.useEffect)(()=>{e.status().then(i=>{r(i)})},[]);let o=!!je(),n="...",s="...";if(t){let{status:i,userEmail:a,serverUrl:c}=t;n=i=="unauthenticated"?"\u274C Logged out":`\u{1F512} Locked (${a})`,c?s=c||"":(!c&&o||c&&!o)&&(0,$.confirmAlert)({icon:$.Icon.ExclamationMark,title:"Restart Required",message:"Bitwarden server URL preference has been changed since the extension was opened.",primaryAction:{title:"Close Extension"},dismissAction:{title:"Close Raycast",style:$.Alert.ActionStyle.Cancel}}).then(u=>{u?(0,$.popToRoot)():(0,$.closeMainWindow)()})}return{userMessage:n,serverMessage:s,shouldShowServer:o}}var Wo=oi;var R=require("react/jsx-runtime"),ni=e=>{let{onUnlock:t,lockReason:r}=e,o=H(),[n,s]=(0,ke.useState)(!1),{userMessage:i,serverMessage:a,shouldShowServer:c}=Wo(),u=(0,ke.useRef)(r??o.lockReason).current,[p,y]=(0,ke.useState)(void 0);async function S({password:d}){if(d.length===0)return;let w=await(0,m.showToast)(m.Toast.Style.Animated,"Unlocking Vault...","Please wait");try{if(s(!0),y(void 0),(await o.status()).status=="unauthenticated")try{await o.login()}catch(z){let{displayableError:J=`Please check your ${c?"Server URL, ":""}API Key and Secret.`,treatedError:rt}=jo(z,d);await(0,m.showToast)(m.Toast.Style.Failure,"Failed to log in",J),y(rt),h("Failed to log in",z);return}await t(d),await w.hide()}catch(B){let{displayableError:z="Please check your credentials",treatedError:J}=jo(B,d);await(0,m.showToast)(m.Toast.Style.Failure,"Failed to unlock vault",z),y(J),h("Failed to unlock vault",B)}finally{s(!1)}}let l=async()=>{!p||(await m.Clipboard.copy(p),await(0,m.showToast)(m.Toast.Style.Success,"Error copied to clipboard"))};return(0,R.jsxs)(m.Form,{actions:(0,R.jsxs)(m.ActionPanel,{children:[!n&&(0,R.jsx)(m.Action.SubmitForm,{icon:m.Icon.LockUnlocked,title:"Unlock",onSubmit:S,shortcut:{key:"enter",modifiers:[]}}),!!p&&(0,R.jsx)(m.Action,{onAction:l,title:"Copy Last Error",icon:m.Icon.Bug,style:m.Action.Style.Destructive})]}),children:[c&&(0,R.jsx)(m.Form.Description,{title:"Server URL",text:a}),(0,R.jsx)(m.Form.Description,{title:"Vault Status",text:i}),(0,R.jsx)(m.Form.PasswordField,{autoFocus:!0,id:"password",title:"Master Password"}),!!u&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(m.Form.Description,{title:"\u2139\uFE0F",text:u}),(0,R.jsx)(si,{})]})]})};function si(){let e=(0,m.getPreferenceValues)().repromptIgnoreDuration,t=_o(e);return t?(0,R.jsx)(m.Form.Description,{title:"",text:`Timeout is set to ${t}, this can be configured in the extension settings`}):null}function jo(e,t){let r=Ho(e,{omitSensitiveValue:t}),o;return/Invalid master password/i.test(r)?o="Invalid master password":/Invalid API Key/i.test(r)&&(o="Invalid Client ID or Secret"),{displayableError:o,treatedError:r}}var Ko=ni;var qo=require("react"),ii={token:void 0,isLoading:!0,isLocked:!1,isAuthenticated:!1,passwordHash:void 0,lastActivityTime:void 0,lockReason:void 0},zo=()=>(0,qo.useReducer)((e,t)=>{switch(t.type){case"lock":return{...e,token:void 0,passwordHash:void 0,isLoading:!1,isLocked:!0,lockReason:t.lockReason};case"unlock":return{...e,token:t.token,passwordHash:t.passwordHash,isLocked:!1,isAuthenticated:!0,lockReason:void 0};case"logout":return{...e,token:void 0,passwordHash:void 0,isAuthenticated:!1};case"vaultTimeout":return{...e,isLocked:!0};case"loadSavedState":{let r=!!t.token;return{...e,token:t.token,passwordHash:t.passwordHash,lastActivityTime:t.lastActivityTime,isLoading:!1,isLocked:t.shouldLockVault||!r,isAuthenticated:r,lockReason:t.lockReason}}case"failedLoadSavedState":return{...e,isLoading:!1,isLocked:!0};default:return e}},ii);var W=require("@raycast/api");var Le={getSavedSession:()=>Promise.all([W.LocalStorage.getItem(T.SESSION_TOKEN),W.LocalStorage.getItem(T.REPROMPT_HASH),W.LocalStorage.getItem(T.LAST_ACTIVITY_TIME)]),clearSession:()=>Promise.all([W.LocalStorage.removeItem(T.SESSION_TOKEN),W.LocalStorage.removeItem(T.REPROMPT_HASH)]),saveSession:(e,t)=>Promise.all([W.LocalStorage.setItem(T.SESSION_TOKEN,e),W.LocalStorage.setItem(T.REPROMPT_HASH,t)])},ai="Vault timed out due to inactivity";async function Yo(){let[e,t,r]=await Le.getSavedSession();if(!e||!t)return{shouldLockVault:!0};let o={token:e,passwordHash:t};if(!r)return{...o,shouldLockVault:!1};let n=new Date(r);o.lastActivityTime=n;let s=+(0,W.getPreferenceValues)().repromptIgnoreDuration;if(s===N.NEVER)return{...o,shouldLockVault:!1};let i=Date.now()-n.getTime();return s===N.IMMEDIATELY||i>=s?{...o,shouldLockVault:!0,lockReason:ai}:{...o,shouldLockVault:!1}}var ze=require("@raycast/api"),Y=new ze.Cache({namespace:ze.environment.commandName});var vt=require("react/jsx-runtime"),Jo=(0,D.createContext)(null);function At(e){let t=H(),[r,o]=zo(),n=(0,D.useRef)(!1);(0,D.useEffect)(()=>{if(!t||n.current)return;(async()=>{await s(),n.current=!0})()},[t]),(0,D.useEffect)(()=>{if(!r.token)return;(async()=>{let d=await t.checkLockStatus();if(d==="unauthenticated")return await c();if(d==="locked")return await a()})()},[r.token]);async function s(){try{let l=await Yo();l.token&&t.setSessionToken(l.token),o({type:"loadSavedState",...l}),l.shouldLockVault&&await a(l.lockReason,!0)}catch(l){await a(),o({type:"failedLoadSavedState"}),h("Failed to load saved session state",l)}}async function i(l){let d=await t.unlock(l),w=await Ct(l);await Le.saveSession(d,w),t.setSessionToken(d),o({type:"unlock",token:d,passwordHash:w})}async function a(l,d=!1){if(d){let{status:w}=await t.status();w!=="unauthenticated"&&await t.lock(l)}else await t.lock(l);await Le.clearSession(),o({type:"lock",lockReason:l})}async function c(){await t.logout(),await Le.clearSession(),Y.clear(),o({type:"logout"})}async function u(l){return await Ct(l)===r.passwordHash}let p=(0,D.useMemo)(()=>({token:r.token,isLoading:r.isLoading,isAuthenticated:r.isAuthenticated,isLocked:r.isLocked,active:!r.isLoading&&r.isAuthenticated&&!r.isLocked,lock:a,logout:c,confirmMasterPassword:u}),[r,a,c,u]);if(r.isLoading)return(0,vt.jsx)(Xo.List,{isLoading:!0});let y=r.isLocked||!r.isAuthenticated,S=r.token?e.children:null;return(0,vt.jsx)(Jo.Provider,{value:p,children:y&&e.unlock?(0,vt.jsx)(Ko,{onUnlock:i,lockReason:r.lockReason}):S})}function Se(){let e=(0,D.useContext)(Jo);if(e==null)throw new Error("useSession must be used within a SessionProvider");return e}var ue=require("@raycast/api"),j=require("react");var X=require("react");var ui=require("react/jsx-runtime"),kt=(0,X.createContext)(null),ci=({children:e})=>{let t=(0,X.useRef)(new Map),r=s=>{s instanceof se?t.current.forEach(i=>i(s)):t.current.forEach((i,a)=>{let c=s.find(u=>u.id===a);c&&i(c)})},o=(s,i)=>(t.current.set(s,i),()=>{t.current.delete(s)}),n=(0,X.useMemo)(()=>({listeners:t,publishItems:r,subscribeItem:o}),[]);return(0,ui.jsx)(kt.Provider,{value:n,children:e})},Qo=()=>{let e=(0,X.useContext)(kt);if(e==null)throw new Error("useVaultItemPublisher must be used within a VaultListenersProvider");return e.publishItems},Zo=()=>{let e=(0,X.useContext)(kt);if(e==null)throw new Error("useVaultItemSubscriber must be used within a VaultListenersProvider");return t=>{let r;return new Promise((o,n)=>{let s=e.subscribeItem(t,i=>{try{if(s(),i instanceof se)throw i;o(i),clearTimeout(r)}catch(a){n(a)}});r=setTimeout(()=>{s(),n(new Rt)},15e3)})}},Rt=class extends Error{constructor(){super("Timed out waiting for item"),this.name="SubscriberTimeoutError"}},en=ci;var un=require("@raycast/api");function tn(e){return e.map(t=>({object:t.object,id:t.id,organizationId:t.organizationId,folderId:t.folderId,type:t.type,name:t.name,revisionDate:t.revisionDate,creationDate:t.creationDate,deletedDate:t.deletedDate,favorite:t.favorite,reprompt:t.reprompt,collectionIds:t.collectionIds,secureNote:t.secureNote?{type:t.secureNote.type}:void 0,fields:li(t.fields),login:di(t.login),identity:pi(t.identity),card:mi(t.card),passwordHistory:fi(t.passwordHistory),notes:f(t.notes)}))}function rn(e){return e.map(t=>({object:t.object,id:t.id,name:t.name}))}function li(e){return e?.map(t=>({name:t.name,value:f(t.value),type:t.type,linkedId:t.linkedId}))}function di(e){if(!!e)return{username:e.username,uris:e.uris,password:f(e.password),passwordRevisionDate:f(e.passwordRevisionDate),totp:f(e.totp)}}function pi(e){if(!!e)return{middleName:f(e.middleName),lastName:f(e.lastName),address1:f(e.address1),address2:f(e.address2),address3:f(e.address3),city:f(e.city),state:f(e.state),postalCode:f(e.postalCode),country:f(e.country),company:f(e.company),email:f(e.email),phone:f(e.phone),ssn:f(e.ssn),username:f(e.username),passportNumber:f(e.passportNumber),licenseNumber:f(e.licenseNumber)}}function mi(e){if(!!e)return{cardholderName:f(e.cardholderName),brand:f(e.brand),number:f(e.number),expMonth:f(e.expMonth),expYear:f(e.expYear),code:f(e.code)}}function fi(e){return e?.map(t=>({password:f(t.password),lastUsedDate:f(t.lastUsedDate)}))}function f(e){return e&&Ae}var nn=require("@raycast/api"),Z=require("crypto"),sn=require("react"),on="aes-256-cbc";function an(){let{clientSecret:e}=(0,nn.getPreferenceValues)(),t=(0,sn.useMemo)(()=>hi(e.trim()),[e]);return{encrypt:n=>{let s=(0,Z.randomBytes)(16),i=(0,Z.createCipheriv)(on,t,s),a=Buffer.concat([i.update(n),i.final()]);return{iv:s.toString("hex"),content:a.toString("hex")}},decrypt:(n,s)=>{let i=(0,Z.createDecipheriv)(on,t,Buffer.from(s,"hex"));return Buffer.concat([i.update(Buffer.from(n,"hex")),i.final()]).toString()}}}function hi(e){return Buffer.from((0,Z.createHash)("sha256").update(e).digest("base64").slice(0,32))}var Ye=require("react");function yi(e,t){let r=(0,Ye.useRef)(!1);(0,Ye.useEffect)(()=>{if(!r.current&&!!t)return r.current=!0,e()},[t])}var cn=yi;var Xe={IV:"iv",VAULT:"vault"};function gi(){let{encrypt:e,decrypt:t}=an(),r=(0,un.getPreferenceValues)().shouldCacheVaultItems;return cn(()=>{Y.isEmpty||Y.clear()},!r),{getCachedVault:()=>{try{if(!r)throw new ce;let s=Y.get(Xe.IV),i=Y.get(Xe.VAULT);if(!s||!i)throw new ce;let a=t(i,s);return JSON.parse(a)}catch(s){return s instanceof ce||h("Failed to decrypt cached vault",s),{items:[],folders:[]}}},cacheVault:(s,i)=>{try{if(!r)throw new ce;let a=JSON.stringify({items:tn(s),folders:rn(i)}),c=e(a);Y.set(Xe.VAULT,c.content),Y.set(Xe.IV,c.iv)}catch(a){a instanceof ce||h("Failed to cache vault",a)}}}}var ce=class extends Error{},ln=gi;var Ii=require("react/jsx-runtime"),dn=(0,j.createContext)(null),Si={items:[],folders:[],isLoading:!0},pn=({children:e})=>{let t=Se(),r=H(),o=Qo(),{getCachedVault:n,cacheVault:s}=ln(),[i,a]=(0,j.useReducer)((l,d)=>({...l,...d}),{...Si,...n()}),c=i.items.length==0,u=t.isLoading||i.isLoading;(0,j.useEffect)(()=>{!t.active||t.token&&p()},[t.token,t.active]);async function p(){try{let l=[],d=[];try{[l,d]=await Promise.all([r.listItems(),r.listFolders()]),l.sort(wi)}catch(w){throw o(new se),w}a({items:l,folders:d}),o(l),s(l,d)}catch(l){await(0,ue.showToast)(ue.Toast.Style.Failure,"Failed to load updated vault"),h("Failed to load vault items",l)}finally{a({isLoading:!1})}}async function y(){let l=await(0,ue.showToast)(ue.Toast.Style.Animated,"Syncing Items...");try{await r.sync(),await p(),await l.hide()}catch{await t.logout(),l.style=ue.Toast.Style.Failure,l.message="Failed to sync. Please try logging in again."}}let S=(0,j.useMemo)(()=>({...i,isEmpty:c,isLoading:u,syncItems:y}),[i,c,u,y]);return(0,Ii.jsx)(dn.Provider,{value:S,children:e})};function wi(e,t){return e.favorite&&t.favorite?0:e.favorite?-1:1}var Je=()=>{let e=(0,j.useContext)(dn);if(e==null)throw new Error("useVault must be used within a VaultProvider");return e};var le=require("react/jsx-runtime");function Pi(){let e=Je(),t=Se(),r=async()=>{let n=await(0,C.showToast)(C.Toast.Style.Animated,"Locking Vault...","Please wait");await t.lock("Manually locked by the user"),await n.hide()},o=async()=>{let n=await(0,C.showToast)({title:"Logging Out...",style:C.Toast.Style.Animated});await t.logout(),await n.hide()};return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(C.Action,{title:"Sync Vault",shortcut:{modifiers:["cmd"],key:"r"},icon:C.Icon.ArrowClockwise,onAction:e.syncItems}),(0,le.jsx)(C.Action,{icon:{source:"sf_symbols_lock.svg",tintColor:C.Color.PrimaryText},title:"Lock Vault",shortcut:{modifiers:["cmd","shift"],key:"l"},onAction:r}),(0,le.jsx)(C.Action,{style:C.Action.Style.Destructive,title:"Logout",icon:C.Icon.Logout,onAction:o})]})}var Oe=Pi;var O=require("@raycast/api"),Ln=require("react");var re=require("@raycast/api");var mn=require("react"),Lt=require("react/jsx-runtime"),xi=e=>{let t=mn.Children.toArray(e.children);return e.reverse&&t.reverse(),(0,Lt.jsx)(Lt.Fragment,{children:t})},fn=xi;var Qe=require("react"),hn=(0,Qe.createContext)(null),I=()=>{let e=(0,Qe.useContext)(hn);if(e==null)throw new Error("useSelectVaultItem must be used within a VaultItemContext.Provider");return e},yn=hn;var K=require("@raycast/api");var wn=require("@raycast/api");var Ie=require("@raycast/api");var ee=require("@raycast/api"),we=require("react/jsx-runtime"),Ei=e=>{let{description:t,onConfirm:r}=e;async function o(n){r(n.password)}return(0,we.jsxs)(ee.Form,{navigationTitle:"Confirmation Required",actions:(0,we.jsx)(ee.ActionPanel,{children:(0,we.jsx)(ee.Action.SubmitForm,{title:"Confirm",onSubmit:o,shortcut:{key:"enter",modifiers:[]}})}),children:[(0,we.jsx)(ee.Form.Description,{title:"Confirmation Required for",text:t}),(0,we.jsx)(ee.Form.PasswordField,{autoFocus:!0,id:"password",title:"Master Password"})]})},gn=Ei;var Ti=require("react/jsx-runtime");function bi(e,t){let{description:r="Performing an action that requires the master password"}=t??{},o=Se(),{push:n,pop:s}=(0,Ie.useNavigation)();async function i(a){if(!await o.confirmMasterPassword(a)){await(0,Ie.showToast)(Ie.Toast.Style.Failure,"Failed to unlock vault","Check your credentials");return}s(),setTimeout(e,1)}return()=>n((0,Ti.jsx)(gn,{description:r,onConfirm:i}))}var Sn=bi;var vi=require("react/jsx-runtime");function Ci(e){let{repromptDescription:t,onAction:r,...o}=e,{reprompt:n}=I(),s=Sn(r,{description:t});return(0,vi.jsx)(wn.Action,{...o,onAction:n?s:r})}var U=Ci;var Ze=require("@raycast/api");function Ai(){let e=Zo();async function t(r,o=s=>s,n){let s=o(r);if(!Ri(s))return s;let i=n?await(0,Ze.showToast)(Ze.Toast.Style.Animated,n):void 0,a=o(await e(r.id));return await i?.hide(),a}return t}function Ri(e){try{return typeof e=="object"?JSON.stringify(e).includes(Ae):typeof e=="string"?e===Ae:!1}catch{return!1}}var v=Ai;var Li=require("react/jsx-runtime");function ki(){let e=I(),t=v();if(!e.login?.password)return null;let r=async()=>{try{let n=await t(e,s=>s.login?.password,"Getting password...");n&&await o(n)}catch(n){await(0,K.showToast)(K.Toast.Style.Failure,"Failed to get password"),h("Failed to copy password",n)}},o=async n=>{await K.Clipboard.copy(n,{transient:V("password")}),await(0,K.showHUD)("Copied password to clipboard")};return(0,Li.jsx)(U,{title:"Copy Password",icon:K.Icon.Key,onAction:r,repromptDescription:`Copying the password of <${e.name}>`})}var Ot=ki;var te=require("@raycast/api");var Vi=require("react/jsx-runtime");function Oi(){let e=I(),t=v();if(!e.login?.password)return null;let r=async()=>{try{let o=await t(e,n=>n.login?.password,"Getting password...");o&&await te.Clipboard.paste(o)}catch(o){await(0,te.showToast)(te.Toast.Style.Failure,"Failed to get password"),h("Failed to paste password",o)}};return(0,Vi.jsx)(U,{title:"Paste Password",icon:te.Icon.Key,onAction:r,repromptDescription:`Pasting the password of <${e.name}>`})}var Vt=Oi;var _=require("@raycast/api");var Fi=require("react/jsx-runtime");function _i(){let e=H(),t=I(),r=v();if(!t.login?.totp)return null;let o=async()=>{let n=await(0,_.showToast)(_.Toast.Style.Animated,"Getting TOTP code...");try{let s=await r(t,a=>a.id),i=await e.getTotp(s);await n?.hide(),await _.Clipboard.copy(i,{transient:V("other")}),await(0,_.showHUD)("Copied to clipboard"),await(0,_.closeMainWindow)({clearRootSearch:!0})}catch(s){n.message="Failed to get TOTP",n.style=_.Toast.Style.Failure,h("Failed to copy TOTP",s)}};return(0,Fi.jsx)(U,{title:"Copy TOTP",icon:_.Icon.Clipboard,onAction:o,shortcut:{modifiers:["cmd"],key:"t"},repromptDescription:`Copying the TOTP of <${t.name}>`})}var _t=_i;var k=require("@raycast/api");var In=e=>e.charAt(0).toUpperCase()+e.slice(1);function Pn(e){return"```\n"+e+"\n```"}var et=require("react/jsx-runtime");function Ni(){let{push:e}=(0,k.useNavigation)(),t=I(),r=v();if(!t.notes)return null;let o=async()=>{try{let n=await r(t,s=>s.notes,"Getting secure note...");n&&e((0,et.jsx)(k.Detail,{markdown:Pn(n),actions:(0,et.jsx)(k.ActionPanel,{children:(0,et.jsx)(k.Action.CopyToClipboard,{title:"Copy Secure Note",content:n,transient:V("other")})})}))}catch(n){await(0,k.showToast)(k.Toast.Style.Failure,"Failed to get secure note"),h("Failed to show secure note",n)}};return(0,et.jsx)(U,{title:"Show Secure Note",icon:k.Icon.BlankDocument,onAction:o,repromptDescription:`Showing the note of <${t.name}>`})}var Ft=Ni;var M=require("@raycast/api");var Mi=require("react/jsx-runtime");function Ui(){let e=I(),t=v();if(!e.login?.username)return null;let r=async()=>{try{let o=await t(e,n=>n.login?.username,"Getting username...");o&&(await M.Clipboard.copy(o,{transient:V("other")}),await(0,M.showHUD)("Copied to clipboard"))}catch(o){await(0,M.showToast)(M.Toast.Style.Failure,"Failed to get username"),h("Failed to copy username",o)}};return(0,Mi.jsx)(M.Action,{title:"Copy Username",icon:M.Icon.Person,onAction:r,shortcut:{modifiers:["cmd"],key:"u"}})}var Nt=Ui;var P=require("@raycast/api");var Pe=require("react/jsx-runtime");function Gi(){let e=I(),t=v(),r=Object.fromEntries(e.login?.uris?.filter(a=>a.uri).map((a,c)=>[`URI ${c+1}`,a.uri])||[]),o=a=>{let c=Object.fromEntries(a.fields?.map(u=>[u.name,u.value])||[]);return{notes:a.notes,...a.card,...a.identity,...c}},n=o(e),s=a=>async()=>{try{let c=await t(e,u=>u.login?.uris?.[a],"Getting uri...");c?.uri&&(await P.Clipboard.copy(c.uri,{transient:V("other")}),await(0,P.showHUD)("Copied to clipboard"),await(0,P.closeMainWindow)())}catch(c){await(0,P.showToast)(P.Toast.Style.Failure,"Failed to get uri"),h("Failed to copy uri",c)}},i=a=>async()=>{try{let c=await t(e,u=>o(u)[a],`Getting ${a}...`);c&&(await P.Clipboard.copy(c,{transient:V("other")}),await(0,P.showHUD)("Copied to clipboard"),await(0,P.closeMainWindow)())}catch(c){await(0,P.showToast)(P.Toast.Style.Failure,`Failed to get ${a}`),h(`Failed to copy ${a}`,c)}};return(0,Pe.jsxs)(Pe.Fragment,{children:[Object.entries(r).map(([a,c],u)=>c?(0,Pe.jsx)(P.Action,{title:`Copy ${a}`,icon:P.Icon.Clipboard,onAction:s(u)},`${u}-${a}`):null),Object.entries(n).map(([a,c],u)=>{if(!c)return null;let p=a,y=In(p);return(0,Pe.jsx)(U,{title:`Copy ${y}`,icon:P.Icon.Clipboard,onAction:i(p),repromptDescription:`Copying the ${y} of <${e.name}>`},`${u}-${p}`)})]})}var Ut=Gi;var q=require("@raycast/api");var Bi=require("react/jsx-runtime");function Di(){let e=I(),t=v();return xn(e)?(0,Bi.jsx)(q.Action,{title:"Open in Browser",onAction:async()=>{try{let o=await t(e,xn,"Getting URL...");o&&await(0,q.open)(o)}catch(o){await(0,q.showToast)(q.Toast.Style.Failure,"Failed to get URL"),h("Failed to open URL in browser",o)}},icon:q.Icon.Globe,shortcut:{modifiers:["cmd"],key:"o"}}):null}function xn(e){return e.login?.uris?.[0]?.uri}var Mt=Di;var L=require("@raycast/api");var Hi={1:"01 - January",2:"02 - February",3:"03 - March",4:"04 - April",5:"05 - May",6:"06 - June",7:"07 - July",8:"08 - August",9:"09 - September",10:"10 - October",11:"11 - November",12:"12 - December"},$i={expMonth:e=>Hi[e]},En={cardholderName:"Cardholder name",number:"Number",code:"Security code (CVV)",expMonth:"Expiration month",expYear:"Expiration year",brand:"Brand"},bn=(e,t)=>$i[e]?.(t)??t;function Tn(e){return`# \u{1F4B3} Card Details
---
&nbsp;
${Object.entries(e).map(([t,r])=>r?`- **${En[t]}**: ${bn(t,r)}`:null).join(`
`)}
`}function Cn(e){return Object.entries(e).map(([t,r])=>r?`${En[t]}: ${bn(t,r)}`:null).filter(Boolean).join(`
`)}var tt=require("react/jsx-runtime");function Wi(){let{push:e}=(0,L.useNavigation)(),t=I(),r=v();if(!t.card)return null;let o=async()=>{try{let n=await r(t,s=>s.card,"Getting card details...");n&&e((0,tt.jsx)(L.Detail,{markdown:Tn(n),actions:(0,tt.jsx)(L.ActionPanel,{children:(0,tt.jsx)(L.Action.CopyToClipboard,{title:"Copy Card Details",content:Cn(n),transient:V("other")})})}))}catch(n){await(0,L.showToast)(L.Toast.Style.Failure,"Failed to get card details"),h("Failed to show card details",n)}};return(0,tt.jsx)(U,{title:"Show Card Details",icon:L.Icon.CreditCard,onAction:o,repromptDescription:`Showing the card details of <${t.name}>`})}var Gt=Wi;var A=require("react/jsx-runtime"),{primaryAction:ji}=(0,re.getPreferenceValues)(),Ki=()=>{let{login:e,card:t}=I();return(0,A.jsxs)(re.ActionPanel,{children:[!!e&&(0,A.jsxs)(re.ActionPanel.Section,{children:[(0,A.jsxs)(fn,{reverse:ji==="copy",children:[(0,A.jsx)(Vt,{}),(0,A.jsx)(Ot,{})]}),(0,A.jsx)(_t,{}),(0,A.jsx)(Nt,{}),(0,A.jsx)(Mt,{})]}),!!t&&(0,A.jsxs)(re.ActionPanel.Section,{children:[(0,A.jsx)(Gt,{}),(0,A.jsx)(Ft,{})]}),(0,A.jsx)(re.ActionPanel.Section,{children:(0,A.jsx)(Ut,{})}),(0,A.jsx)(re.ActionPanel.Section,{children:(0,A.jsx)(Oe,{})})]})},vn=Ki;var An=require("@raycast/api"),Dt=require("url");function Rn(e){let t=[e.name];if(e.card){let{brand:o,number:n}=e.card;if(t.push(o),n!==null){let s=/^3[47]/.test(n);t.push(n.substring(n.length-(s?5:4),n.length))}}if(t.push(e.login?.username),e.login?.uris){for(let o of e.login.uris)if(o.uri!==null)try{t.push(...new Dt.URL(o.uri).hostname.split("."))}catch{}}return[...new Set(t.filter(o=>!!o))]}function kn(e){try{return`https://icons.bitwarden.net/${new Dt.URL(e).hostname}/icon.png`}catch{return An.Icon.Globe}}var Bt=require("react/jsx-runtime"),{fetchFavicons:qi}=(0,O.getPreferenceValues)(),zi=e=>{let{item:t,folder:r}=e,o=(0,Ln.useMemo)(()=>Rn(t),[t]);return(0,Bt.jsx)(yn.Provider,{value:t,children:(0,Bt.jsx)(O.List.Item,{id:t.id,title:t.name,keywords:o,accessories:Ji(t,r),icon:Xi(t),subtitle:t.login?.username||void 0,actions:(0,Bt.jsx)(vn,{})})})},Yi={1:O.Icon.Globe,2:O.Icon.BlankDocument,3:O.Icon.List,4:O.Icon.Person};function Xi(e){let t=e.login?.uris?.[0]?.uri;return qi&&t?kn(t):Yi[e.type]}function Ji(e,t){let r=[];return t?.id&&r.push({icon:{source:O.Icon.Folder,tintColor:O.Color.SecondaryText},tooltip:"Folder",text:t.name}),e.favorite&&r.push({icon:{source:O.Icon.Star,tintColor:O.Color.Yellow},tooltip:"Favorite"}),r}var On=zi;var F=require("react/jsx-runtime"),Qi=()=>(0,F.jsx)(Ee,{children:(0,F.jsx)(Do,{children:(0,F.jsx)(At,{unlock:!0,children:(0,F.jsx)(en,{children:(0,F.jsx)(pn,{children:(0,F.jsx)(Zi,{})})})})})});function Zi(){let{items:e,folders:t,isLoading:r,isEmpty:o}=Je();return(0,F.jsxs)(oe.List,{isLoading:r,children:[e.map(n=>(0,F.jsx)(On,{item:n,folder:ea(t,n)},n.id)),r?(0,F.jsx)(oe.List.EmptyView,{icon:oe.Icon.ArrowClockwise,title:"Loading...",description:"Please wait."}):(0,F.jsx)(oe.List.EmptyView,{icon:{source:"bitwarden-64.png"},title:o?"Vault empty.":"No matching items found.",description:o?"Hit the sync button to sync your vault or try logging in again.":"Hit the sync button to sync your vault.",actions:!r&&(0,F.jsx)(oe.ActionPanel,{children:(0,F.jsx)(Oe,{})})})]})}function ea(e,t){return e.find(r=>r.id===t.folderId)}var ta=Qi;0&&(module.exports={});
